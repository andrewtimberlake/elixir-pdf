defmodule Pdf.Color.RGB do
  defstruct r: 0, g: 0, b: 0, opacity: 100.0

  def new(r, g, b, opacity \\ 100.0) when opacity >= 0 and opacity <= 100.0 do
    %__MODULE__{
      r: rgb_to_pdf(r),
      g: rgb_to_pdf(g),
      b: rgb_to_pdf(b),
      opacity: opacity / 1
    }
  end

  defp rgb_to_pdf(r) when r >= 0 and r <= 255 do
    Float.ceil(r / 255, 3)
  end

  def to_iolist(%__MODULE__{} = color) do
    [
      Float.to_string(color.r),
      " ",
      Float.to_string(color.g),
      " ",
      Float.to_string(color.b)
    ]
  end

  def size(%__MODULE__{} = color) do
    color
    |> to_iolist
    |> :binary.list_to_bin()
    |> byte_size()
  end

  defimpl Pdf.Size do
    def size_of(%Pdf.Color.RGB{} = color), do: Pdf.Color.RGB.size(color)
  end

  defimpl Pdf.Export do
    def to_iolist(%Pdf.Color.RGB{} = color), do: Pdf.Color.RGB.to_iolist(color)
  end

  def aliceblue, do: new(0xF0, 0xF8, 0xFF)
  def antiquewhite, do: new(0xFA, 0xEB, 0xD7)
  def aqua, do: new(0x00, 0xFF, 0xFF)
  def aquamarine, do: new(0x7F, 0xFF, 0xD4)
  def azure, do: new(0xF0, 0xFF, 0xFF)
  def beige, do: new(0xF5, 0xF5, 0xDC)
  def bisque, do: new(0xFF, 0xE4, 0xC4)
  def rebeccapurple, do: new(0x66, 0x33, 0x99)
  def beccapurple, do: new(0x66, 0x33, 0x99)
  def black, do: new(0x00, 0x00, 0x00)
  def blanchedalmond, do: new(0xFF, 0xEB, 0xCD)
  def blue, do: new(0x00, 0x00, 0xFF)
  def blueviolet, do: new(0x8A, 0x2B, 0xE2)
  def brown, do: new(0xA5, 0x2A, 0x2A)
  def burlywood, do: new(0xDE, 0xB8, 0x87)
  def carnation, do: new(0xFF, 0x5E, 0xD0)
  def cadetblue, do: new(0x5F, 0x9E, 0xA0)
  def cayenne, do: new(0x8D, 0x00, 0x00)
  def chartreuse, do: new(0x7F, 0xFF, 0x00)
  def chocolate, do: new(0xD2, 0x69, 0x1E)
  def coral, do: new(0xFF, 0x7F, 0x50)
  def cornflowerblue, do: new(0x64, 0x95, 0xED)
  def cornsilk, do: new(0xFF, 0xF8, 0xDC)
  def crimson, do: new(0xDC, 0x14, 0x3C)
  def cyan, do: new(0x00, 0xFF, 0xFF)
  def darkblue, do: new(0x00, 0x00, 0x8B)
  def darkcyan, do: new(0x00, 0x8B, 0x8B)
  def darkgoldenrod, do: new(0xB8, 0x86, 0x0B)
  def darkgray, do: new(0xA9, 0xA9, 0xA9)
  def darkgrey, do: new(0xA9, 0xA9, 0xA9)
  def darkgreen, do: new(0x00, 0x64, 0x00)
  def darkkhaki, do: new(0xBD, 0xB7, 0x6B)
  def darkmagenta, do: new(0x8B, 0x00, 0x8B)
  def darkolivegreen, do: new(0x55, 0x6B, 0x2F)
  def darkorange, do: new(0xFF, 0x8C, 0x00)
  def darkorchid, do: new(0x99, 0x32, 0xCC)
  def darkred, do: new(0x8B, 0x00, 0x00)
  def darksalmon, do: new(0xE9, 0x96, 0x7A)
  def darkseagreen, do: new(0x8F, 0xBC, 0x8F)
  def darkslateblue, do: new(0x48, 0x3D, 0x8B)
  def darkslategray, do: new(0x2F, 0x4F, 0x4F)
  def darkslategrey, do: new(0x2F, 0x4F, 0x4F)
  def darkturquoise, do: new(0x00, 0xCE, 0xD1)
  def darkviolet, do: new(0x94, 0x00, 0xD3)
  def deeppink, do: new(0xFF, 0x14, 0x93)
  def deepskyblue, do: new(0x00, 0xBF, 0xBF)
  def dimgray, do: new(0x69, 0x69, 0x69)
  def dimgrey, do: new(0x69, 0x69, 0x69)
  def dodgerblue, do: new(0x1E, 0x90, 0xFF)
  def feldspar, do: new(0xD1, 0x92, 0x75)
  def firebrick, do: new(0xB2, 0x22, 0x22)
  def floralwhite, do: new(0xFF, 0xFA, 0xF0)
  def forestgreen, do: new(0x22, 0x8B, 0x22)
  def fuchsia, do: new(0xFF, 0x00, 0xFF)
  def gainsboro, do: new(0xDC, 0xDC, 0xDC)
  def ghostwhite, do: new(0xF8, 0xF8, 0xFF)
  def gold, do: new(0xFF, 0xD7, 0x00)
  def goldenrod, do: new(0xDA, 0xA5, 0x20)
  def gray, do: new(0x80, 0x80, 0x80)
  def grey, do: new(0x80, 0x80, 0x80)
  def gray10, do: new(10, 10, 10, 100.0)
  def grey10, do: new(10, 10, 10, 100.0)
  def gray20, do: new(20, 20, 20, 100.0)
  def grey20, do: new(20, 20, 20, 100.0)
  def gray30, do: new(30, 30, 30, 100.0)
  def grey30, do: new(30, 30, 30, 100.0)
  def gray40, do: new(40, 40, 40, 100.0)
  def grey40, do: new(40, 40, 40, 100.0)
  def gray50, do: new(50, 50, 50, 100.0)
  def grey50, do: new(50, 50, 50, 100.0)
  def gray60, do: new(60, 60, 60, 100.0)
  def grey60, do: new(60, 60, 60, 100.0)
  def gray70, do: new(70, 70, 70, 100.0)
  def grey70, do: new(70, 70, 70, 100.0)
  def gray80, do: new(80, 80, 80, 100.0)
  def grey80, do: new(80, 80, 80, 100.0)
  def gray90, do: new(90, 90, 90, 100.0)
  def grey90, do: new(90, 90, 90, 100.0)
  def green, do: new(0x00, 0x80, 0x00)
  def greenyellow, do: new(0xAD, 0xFF, 0x2F)
  def honeydew, do: new(0xF0, 0xFF, 0xF0)
  def hotpink, do: new(0xFF, 0x69, 0xB4)
  def indianred, do: new(0xCD, 0x5C, 0x5C)
  def indigo, do: new(0x4B, 0x00, 0x82)
  def ivory, do: new(0xFF, 0xFF, 0xF0)
  def khaki, do: new(0xF0, 0xE6, 0x8C)
  def lavender, do: new(0xE6, 0xE6, 0xFA)
  def lavenderblush, do: new(0xFF, 0xF0, 0xF5)
  def lawngreen, do: new(0x7C, 0xFC, 0x00)
  def lemonchiffon, do: new(0xFF, 0xFA, 0xCD)
  def lightblue, do: new(0xAD, 0xD8, 0xE6)
  def lightcoral, do: new(0xF0, 0x80, 0x80)
  def lightcyan, do: new(0xE0, 0xFF, 0xFF)
  def lightgoldenrodyellow, do: new(0xFA, 0xFA, 0xD2)
  def lightgray, do: new(0xD3, 0xD3, 0xD3)
  def lightgrey, do: new(0xD3, 0xD3, 0xD3)
  def lightgreen, do: new(0x90, 0xEE, 0x90)
  def lightpink, do: new(0xFF, 0xB6, 0xC1)
  def lightsalmon, do: new(0xFF, 0xA0, 0x7A)
  def lightseagreen, do: new(0x20, 0xB2, 0xAA)
  def lightskyblue, do: new(0x87, 0xCE, 0xFA)
  def lightslateblue, do: new(0x84, 0x70, 0xFF)
  def lightslategray, do: new(0x77, 0x88, 0x99)
  def lightslategrey, do: new(0x77, 0x88, 0x99)
  def lightsteelblue, do: new(0xB0, 0xC4, 0xDE)
  def lightyellow, do: new(0xFF, 0xFF, 0xE0)
  def lime, do: new(0x00, 0xFF, 0x00)
  def limegreen, do: new(0x32, 0xCD, 0x32)
  def linen, do: new(0xFA, 0xF0, 0xE6)
  def magenta, do: new(0xFF, 0x00, 0xFF)
  def maroon, do: new(0x80, 0x00, 0x00)
  def mediumaquamarine, do: new(0x66, 0xCD, 0xAA)
  def mediumblue, do: new(0x00, 0x00, 0xCD)
  def mediumorchid, do: new(0xBA, 0x55, 0xD3)
  def mediumpurple, do: new(0x93, 0x70, 0xDB)
  def mediumseagreen, do: new(0x3C, 0xB3, 0x71)
  def mediumslateblue, do: new(0x7B, 0x68, 0xEE)
  def mediumspringgreen, do: new(0x00, 0xFA, 0x9A)
  def mediumturquoise, do: new(0x48, 0xD1, 0xCC)
  def mediumvioletred, do: new(0xC7, 0x15, 0x85)
  def midnightblue, do: new(0x19, 0x19, 0x70)
  def mintcream, do: new(0xF5, 0xFF, 0xFA)
  def mistyrose, do: new(0xFF, 0xE4, 0xE1)
  def moccasin, do: new(0xFF, 0xE4, 0xB5)
  def navajowhite, do: new(0xFF, 0xDE, 0xAD)
  def navy, do: new(0x00, 0x00, 0x80)
  def oldlace, do: new(0xFD, 0xF5, 0xE6)
  def olive, do: new(0x80, 0x80, 0x00)
  def olivedrab, do: new(0x6B, 0x8E, 0x23)
  def orange, do: new(0xFF, 0xA5, 0x00)
  def orangered, do: new(0xFF, 0x45, 0x00)
  def orchid, do: new(0xDA, 0x70, 0xD6)
  def palegoldenrod, do: new(0xEE, 0xE8, 0xAA)
  def palegreen, do: new(0x98, 0xFB, 0x98)
  def paleturquoise, do: new(0xAF, 0xEE, 0xEE)
  def palevioletred, do: new(0xDB, 0x70, 0x93)
  def papayawhip, do: new(0xFF, 0xEF, 0xD5)
  def peachpuff, do: new(0xFF, 0xDA, 0xB9)
  def peru, do: new(0xCD, 0x85, 0x3F)
  def pink, do: new(0xFF, 0xC0, 0xCB)
  def plum, do: new(0xDD, 0xA0, 0xDD)
  def powderblue, do: new(0xB0, 0xE0, 0xE6)
  def purple, do: new(0x80, 0x00, 0x80)
  def red, do: new(0xFF, 0x00, 0x00)
  def rosybrown, do: new(0xBC, 0x8F, 0x8F)
  def royalblue, do: new(0x41, 0x69, 0xE1)
  def saddlebrown, do: new(0x8B, 0x45, 0x13)
  def salmon, do: new(0xFA, 0x80, 0x72)
  def sandybrown, do: new(0xF4, 0xA4, 0x60)
  def seagreen, do: new(0x2E, 0x8B, 0x57)
  def seashell, do: new(0xFF, 0xF5, 0xEE)
  def sienna, do: new(0xA0, 0x52, 0x2D)
  def silver, do: new(0xC0, 0xC0, 0xC0)
  def skyblue, do: new(0x87, 0xCE, 0xEB)
  def slateblue, do: new(0x6A, 0x5A, 0xCD)
  def slategray, do: new(0x70, 0x80, 0x90)
  def slategrey, do: new(0x70, 0x80, 0x90)
  def snow, do: new(0xFF, 0xFA, 0xFA)
  def springgreen, do: new(0x00, 0xFF, 0x7F)
  def steelblue, do: new(0x46, 0x82, 0xB4)
  def tan, do: new(0xD2, 0xB4, 0x8C)
  def teal, do: new(0x00, 0x80, 0x80)
  def thistle, do: new(0xD8, 0xBF, 0xD8)
  def tomato, do: new(0xFF, 0x63, 0x47)
  def turquoise, do: new(0x40, 0xE0, 0xD0)
  def violet, do: new(0xEE, 0x82, 0xEE)
  def violetred, do: new(0xD0, 0x20, 0x90)
  def wheat, do: new(0xF5, 0xDE, 0xB3)
  def white, do: new(0xFF, 0xFF, 0xFF)
  def whitesmoke, do: new(0xF5, 0xF5, 0xF5)
  def yellow, do: new(0xFF, 0xFF, 0x00)
  def yellowgreen, do: new(0x9A, 0xCD, 0x32)
end
